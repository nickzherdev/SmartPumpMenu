
# SmartPump project



## Links
Контроллер теплицы своими руками [10.05]
https://alexgyver.ru/gyvercontrol/

Простейшая система автополива растений
https://alexgyver.ru/pump-sleep/

Датчик уровня воды
https://radioprog.ru/post/828

Telegram: Control ESP32/ESP8266 Outputs (Arduino IDE)
https://randomnerdtutorials.com/telegram-control-esp32-esp8266-nodemcu-outputs/

## Done
- просыпается по таймеру, поливает, засыпает
- можно полить вручную со сбросом таймера
- на дисплее можно посмотреть, когда последний раз был полив
- есть защита от сухого хода мотора (по двум проводочкам)
- около 10 микроампер потребление во сне
- питание от батареек / USB
- пасхалка при ручном поливе когда воды не осталось :)
- Энкодер и ГУИ с настройкой периода и продолжительности
- Подключение к сети
- Телеграм бот для настройки периода и продолжительности


### TODO

- Функциональность
    - поддержка нескольких насосов
    - ручное управление любым насосом
    - Управление мощным мотором от сети

- Уведомления
    - оповещение о низком заряде в телегу
    - посылка реквеста о добавлении воды
    - оповещения об отсутствии воды в телегу
    - обновление статуса на веб-странице при каждом действии

- POWER SAVING
    - Turn off OLED when not in use
    - When OLED and Encoder are in use - pause checking new messages
    - запись настроек периода в энергонезависимую память

- Питание
    - резервирование питания на батарейках при отключении энергии.
    - переключение на сеть при появлении питания
    - логика и статус питаются от батареи
    - моторы питаются от эл-ва (и батареи если отключилась сеть)


## Snippets

// раздефайнить или задефайнить для использования
//#define DEBUG_ENABLE

#ifdef DEBUG_ENABLE
#define DEBUG(x) Serial.println(x)
#else
#define DEBUG(x)
#endif

Если DEBUG задефайнен, то DEBUG_PRINT – это макро-функция, которая выводит значение в порт. А если не задефайнен – все вызовы DEBUG_PRINT просто убираются из кода и экономят память!

